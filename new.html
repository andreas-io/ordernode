<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>iofrm</title>
Â  Â  <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
Â  Â  <link rel="stylesheet" type="text/css" href="css/fontawesome-all.min.css">
Â  Â  <link rel="stylesheet" type="text/css" href="css/iofrm-style.css">
Â  Â  <link rel="stylesheet" type="text/css" href="css/iofrm-theme17.css">

    <style>
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none; /* Hidden by default */
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .popup-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            max-width: 90%;
            width: 400px;
        }

        .popup-content h3 {
            color: #28a745; /* Success color */
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .popup-content p {
            font-size: 1.1rem;
            margin-bottom: 25px;
            /* Ensure bold text is visible */
            font-weight: 500;
        }
        
        /* Style for the bold parts of the message */
        #popup-message strong {
            font-weight: bold;
            color: #007bff; /* Highlight important numbers */
        }

        .popup-close-btn {
            background: #007bff; /* Primary color */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
        }

        .popup-close-btn:hover {
            background: #0056b3;
        }
    </style>
</head>
<body onload="document.getElementById('username').focus();">
Â  Â  <div class="form-body without-side">
Â  Â  Â  Â  <div class="row">
Â  Â  Â  Â  Â  Â  <div class="img-holder">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-holder">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img src="images/graphic3.svg" alt="">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="form-holder">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-content">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-items">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-icon">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="icon-holder"><img src="images/css_logo.jpeg" alt=""></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>Welcome to the Port of Felixstowe PPE Ordering Station</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Swipe your card to quickly access your Chelmsford Safety account.</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img src="images/swipe.gif" alt="Swipe Card" style="max-width: 100%; height: auto; display: block; margin: 0 auto;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form id="login-form" action="https://shop.chelmsfordsafety.co.uk/login.php" method="POST">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input class="form-control" type="password" id="username" name="username" placeholder="Swipe your card." required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="hidden" id="password" name="password" value="FEL008">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-button">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="ibtn">Login</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img src="images/felix-logo.png" alt="Swipe Card" style="max-width: 100%; height: auto; padding-top: 15px; display: block; margin: 0 auto;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

    <div id="notification-popup" class="popup-overlay">
        <div class="popup-content">
            <h3 id="popup-title">Order Ready for Pickup! ðŸ“¦</h3>
            <p id="popup-message"></p>
            <button class="popup-close-btn" onclick="closePopup()">Close</button>
        </div>
    </div>
    Â  Â  <script src="js/jquery.min.js"></script>
Â  Â  <script src="js/popper.min.js"></script>
Â  Â  <script src="js/bootstrap.min.js"></script>
Â  Â  <script src="js/main.js"></script>
Â  Â  <script>
        // **Helper function to generate random numbers**
        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // **Function to display the pickup notification**
        function showPickupNotification(cardNumber) {
            // Generate random order and locker numbers
            var orderNumber = 'P' + getRandomInt(100000, 999999);
            var lockerNumber = getRandomInt(1, 50);

            // Update popup content. Using <strong> for better emphasis.
            document.getElementById('popup-message').innerHTML =
                'The order for card number <strong>' + cardNumber + '</strong> is ready! <br><br>' +
                '<strong>Order Number:</strong> ' + orderNumber + '<br>' +
                '<strong>Locker Number:</strong> ' + lockerNumber;

            // Display the popup
            document.getElementById('notification-popup').style.display = 'flex';
        }

        // **Function to close the pickup notification**
        function closePopup() {
            document.getElementById('notification-popup').style.display = 'none';
            // Clear the input field after closing the popup and refocus
            document.getElementById('username').value = '';
            document.getElementById('username').focus();
        }

Â  Â  Â  Â  document.getElementById('username').addEventListener('input', function(event) {
Â  Â  Â  Â  Â  Â  var inputData = event.target.value;

Â  Â  Â  Â  Â  Â  // **Original Login Logic (starts with '%' and ends with '?')**
Â  Â  Â  Â  Â  Â  if (inputData.startsWith('%') && inputData.endsWith('?')) {
Â  Â  Â  Â  Â  Â  Â  Â  // Remove the '%' and '?' characters and use the remaining text as the username
Â  Â  Â  Â  Â  Â  Â  Â  var username = inputData.slice(1, inputData.length - 1);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('username').value = username;
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(function() {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('login-form').submit(); // Auto-submit the form
Â  Â  Â  Â  Â  Â  Â  Â  }, 500); // Short delay to process the swipe data

Â  Â  Â  Â  Â  Â  // **New Pickup Notification Logic (starts with ';' and ends with '^^')**
            // Change the characters ';' and '^^' if your notification card reader uses different delimiters.
Â  Â  Â  Â  Â  Â  } else if (inputData.startsWith(';') && inputData.endsWith('^^')) {
                // The card data is the card number for the notification
                var cardNumber = inputData.slice(1, inputData.length - 2);

                // Clear the input field immediately
                document.getElementById('username').value = '';

                // Show the order notification popup
                showPickupNotification(cardNumber);

                // Remove focus to ensure the user must swipe again after closing the popup
                event.target.blur(); 
                
            }
Â  Â  Â  Â  });
Â  Â  </script>
</body>
</html>
